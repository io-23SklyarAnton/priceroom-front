{"version":3,"names":["Object","defineProperty","exports","value","_utils","_interopRequireDefault","require","_AxiosError","_FormData","e","__esModule","_typeof","o","Symbol","iterator","constructor","prototype","isVisitable","thing","utils","isPlainObject","isArray","removeBrackets","key","endsWith","slice","renderKey","path","dots","concat","map","each","token","i","join","isFlatArray","arr","some","predicates","toFlatObject","filter","prop","test","toFormData","obj","formData","options","isObject","TypeError","PlatformFormData","FormData","metaTokens","indexes","defined","option","source","isUndefined","visitor","defaultVisitor","_Blob","Blob","useBlob","isSpecCompliantForm","isFunction","convertValue","isDate","toISOString","isBlob","AxiosError","isArrayBuffer","isTypedArray","Buffer","from","JSON","stringify","isFileList","toArray","forEach","el","index","append","stack","exposedHelpers","assign","build","indexOf","Error","push","result","call","isString","trim","pop","_default"],"sources":["toFormData.js"],"sourcesContent":["'use strict';\n\nimport utils from '../utils.js';\nimport AxiosError from '../core/AxiosError.js';\n// temporary hotfix to avoid circular references until AxiosURLSearchParams is refactored\nimport PlatformFormData from '../platform/node/classes/FormData.js';\n\n/**\n * Determines if the given thing is a array or js object.\n *\n * @param {string} thing - The object or array to be visited.\n *\n * @returns {boolean}\n */\nfunction isVisitable(thing) {\n  return utils.isPlainObject(thing) || utils.isArray(thing);\n}\n\n/**\n * It removes the brackets from the end of a string\n *\n * @param {string} key - The key of the parameter.\n *\n * @returns {string} the key without the brackets.\n */\nfunction removeBrackets(key) {\n  return utils.endsWith(key, '[]') ? key.slice(0, -2) : key;\n}\n\n/**\n * It takes a path, a key, and a boolean, and returns a string\n *\n * @param {string} path - The path to the current key.\n * @param {string} key - The key of the current object being iterated over.\n * @param {string} dots - If true, the key will be rendered with dots instead of brackets.\n *\n * @returns {string} The path to the current key.\n */\nfunction renderKey(path, key, dots) {\n  if (!path) return key;\n  return path.concat(key).map(function each(token, i) {\n    // eslint-disable-next-line no-param-reassign\n    token = removeBrackets(token);\n    return !dots && i ? '[' + token + ']' : token;\n  }).join(dots ? '.' : '');\n}\n\n/**\n * If the array is an array and none of its elements are visitable, then it's a flat array.\n *\n * @param {Array<any>} arr - The array to check\n *\n * @returns {boolean}\n */\nfunction isFlatArray(arr) {\n  return utils.isArray(arr) && !arr.some(isVisitable);\n}\n\nconst predicates = utils.toFlatObject(utils, {}, null, function filter(prop) {\n  return /^is[A-Z]/.test(prop);\n});\n\n/**\n * Convert a data object to FormData\n *\n * @param {Object} obj\n * @param {?Object} [formData]\n * @param {?Object} [options]\n * @param {Function} [options.visitor]\n * @param {Boolean} [options.metaTokens = true]\n * @param {Boolean} [options.dots = false]\n * @param {?Boolean} [options.indexes = false]\n *\n * @returns {Object}\n **/\n\n/**\n * It converts an object into a FormData object\n *\n * @param {Object<any, any>} obj - The object to convert to form data.\n * @param {string} formData - The FormData object to append to.\n * @param {Object<string, any>} options\n *\n * @returns\n */\nfunction toFormData(obj, formData, options) {\n  if (!utils.isObject(obj)) {\n    throw new TypeError('target must be an object');\n  }\n\n  // eslint-disable-next-line no-param-reassign\n  formData = formData || new (PlatformFormData || FormData)();\n\n  // eslint-disable-next-line no-param-reassign\n  options = utils.toFlatObject(options, {\n    metaTokens: true,\n    dots: false,\n    indexes: false\n  }, false, function defined(option, source) {\n    // eslint-disable-next-line no-eq-null,eqeqeq\n    return !utils.isUndefined(source[option]);\n  });\n\n  const metaTokens = options.metaTokens;\n  // eslint-disable-next-line no-use-before-define\n  const visitor = options.visitor || defaultVisitor;\n  const dots = options.dots;\n  const indexes = options.indexes;\n  const _Blob = options.Blob || typeof Blob !== 'undefined' && Blob;\n  const useBlob = _Blob && utils.isSpecCompliantForm(formData);\n\n  if (!utils.isFunction(visitor)) {\n    throw new TypeError('visitor must be a function');\n  }\n\n  function convertValue(value) {\n    if (value === null) return '';\n\n    if (utils.isDate(value)) {\n      return value.toISOString();\n    }\n\n    if (!useBlob && utils.isBlob(value)) {\n      throw new AxiosError('Blob is not supported. Use a Buffer instead.');\n    }\n\n    if (utils.isArrayBuffer(value) || utils.isTypedArray(value)) {\n      return useBlob && typeof Blob === 'function' ? new Blob([value]) : Buffer.from(value);\n    }\n\n    return value;\n  }\n\n  /**\n   * Default visitor.\n   *\n   * @param {*} value\n   * @param {String|Number} key\n   * @param {Array<String|Number>} path\n   * @this {FormData}\n   *\n   * @returns {boolean} return true to visit the each prop of the value recursively\n   */\n  function defaultVisitor(value, key, path) {\n    let arr = value;\n\n    if (value && !path && typeof value === 'object') {\n      if (utils.endsWith(key, '{}')) {\n        // eslint-disable-next-line no-param-reassign\n        key = metaTokens ? key : key.slice(0, -2);\n        // eslint-disable-next-line no-param-reassign\n        value = JSON.stringify(value);\n      } else if (\n        (utils.isArray(value) && isFlatArray(value)) ||\n        ((utils.isFileList(value) || utils.endsWith(key, '[]')) && (arr = utils.toArray(value))\n        )) {\n        // eslint-disable-next-line no-param-reassign\n        key = removeBrackets(key);\n\n        arr.forEach(function each(el, index) {\n          !(utils.isUndefined(el) || el === null) && formData.append(\n            // eslint-disable-next-line no-nested-ternary\n            indexes === true ? renderKey([key], index, dots) : (indexes === null ? key : key + '[]'),\n            convertValue(el)\n          );\n        });\n        return false;\n      }\n    }\n\n    if (isVisitable(value)) {\n      return true;\n    }\n\n    formData.append(renderKey(path, key, dots), convertValue(value));\n\n    return false;\n  }\n\n  const stack = [];\n\n  const exposedHelpers = Object.assign(predicates, {\n    defaultVisitor,\n    convertValue,\n    isVisitable\n  });\n\n  function build(value, path) {\n    if (utils.isUndefined(value)) return;\n\n    if (stack.indexOf(value) !== -1) {\n      throw Error('Circular reference detected in ' + path.join('.'));\n    }\n\n    stack.push(value);\n\n    utils.forEach(value, function each(el, key) {\n      const result = !(utils.isUndefined(el) || el === null) && visitor.call(\n        formData, el, utils.isString(key) ? key.trim() : key, path, exposedHelpers\n      );\n\n      if (result === true) {\n        build(el, path ? path.concat(key) : [key]);\n      }\n    });\n\n    stack.pop();\n  }\n\n  if (!utils.isObject(obj)) {\n    throw new TypeError('data must be an object');\n  }\n\n  build(obj);\n\n  return formData;\n}\n\nexport default toFormData;\n"],"mappings":"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","ignoreList":[]}