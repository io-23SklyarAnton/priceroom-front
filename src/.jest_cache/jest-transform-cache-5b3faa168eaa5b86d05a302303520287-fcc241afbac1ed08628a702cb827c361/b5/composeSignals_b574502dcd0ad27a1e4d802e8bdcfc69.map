{"version":3,"names":["_CanceledError","_interopRequireDefault","require","_AxiosError","_utils","e","__esModule","composeSignals","signals","timeout","_signals","filter","Boolean","length","controller","AbortController","aborted","onabort","reason","unsubscribe","err","Error","abort","AxiosError","CanceledError","message","timer","setTimeout","concat","ETIMEDOUT","clearTimeout","forEach","signal","removeEventListener","addEventListener","utils","asap","_default","exports"],"sources":["composeSignals.js"],"sourcesContent":["import CanceledError from \"../cancel/CanceledError.js\";\nimport AxiosError from \"../core/AxiosError.js\";\nimport utils from '../utils.js';\n\nconst composeSignals = (signals, timeout) => {\n  const {length} = (signals = signals ? signals.filter(Boolean) : []);\n\n  if (timeout || length) {\n    let controller = new AbortController();\n\n    let aborted;\n\n    const onabort = function (reason) {\n      if (!aborted) {\n        aborted = true;\n        unsubscribe();\n        const err = reason instanceof Error ? reason : this.reason;\n        controller.abort(err instanceof AxiosError ? err : new CanceledError(err instanceof Error ? err.message : err));\n      }\n    }\n\n    let timer = timeout && setTimeout(() => {\n      timer = null;\n      onabort(new AxiosError(`timeout ${timeout} of ms exceeded`, AxiosError.ETIMEDOUT))\n    }, timeout)\n\n    const unsubscribe = () => {\n      if (signals) {\n        timer && clearTimeout(timer);\n        timer = null;\n        signals.forEach(signal => {\n          signal.unsubscribe ? signal.unsubscribe(onabort) : signal.removeEventListener('abort', onabort);\n        });\n        signals = null;\n      }\n    }\n\n    signals.forEach((signal) => signal.addEventListener('abort', onabort));\n\n    const {signal} = controller;\n\n    signal.unsubscribe = () => utils.asap(unsubscribe);\n\n    return signal;\n  }\n}\n\nexport default composeSignals;\n"],"mappings":";;;;;;AAAA,IAAAA,cAAA,GAAAC,sBAAA,CAAAC,OAAA;AACA,IAAAC,WAAA,GAAAF,sBAAA,CAAAC,OAAA;AACA,IAAAE,MAAA,GAAAH,sBAAA,CAAAC,OAAA;AAAgC,SAAAD,uBAAAI,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,gBAAAA,CAAA;AAEhC,IAAME,cAAc,GAAG,SAAjBA,cAAcA,CAAIC,OAAO,EAAEC,OAAO,EAAK;EAC3C,IAAAC,QAAA,GAAkBF,OAAO,GAAGA,OAAO,GAAGA,OAAO,CAACG,MAAM,CAACC,OAAO,CAAC,GAAG,EAAE;IAA3DC,MAAM,GAAAH,QAAA,CAANG,MAAM;EAEb,IAAIJ,OAAO,IAAII,MAAM,EAAE;IACrB,IAAIC,UAAU,GAAG,IAAIC,eAAe,CAAC,CAAC;IAEtC,IAAIC,OAAO;IAEX,IAAMC,OAAO,GAAG,SAAVA,OAAOA,CAAaC,MAAM,EAAE;MAChC,IAAI,CAACF,OAAO,EAAE;QACZA,OAAO,GAAG,IAAI;QACdG,WAAW,CAAC,CAAC;QACb,IAAMC,GAAG,GAAGF,MAAM,YAAYG,KAAK,GAAGH,MAAM,GAAG,IAAI,CAACA,MAAM;QAC1DJ,UAAU,CAACQ,KAAK,CAACF,GAAG,YAAYG,sBAAU,GAAGH,GAAG,GAAG,IAAII,yBAAa,CAACJ,GAAG,YAAYC,KAAK,GAAGD,GAAG,CAACK,OAAO,GAAGL,GAAG,CAAC,CAAC;MACjH;IACF,CAAC;IAED,IAAIM,KAAK,GAAGjB,OAAO,IAAIkB,UAAU,CAAC,YAAM;MACtCD,KAAK,GAAG,IAAI;MACZT,OAAO,CAAC,IAAIM,sBAAU,YAAAK,MAAA,CAAYnB,OAAO,sBAAmBc,sBAAU,CAACM,SAAS,CAAC,CAAC;IACpF,CAAC,EAAEpB,OAAO,CAAC;IAEX,IAAMU,WAAW,GAAG,SAAdA,WAAWA,CAAA,EAAS;MACxB,IAAIX,OAAO,EAAE;QACXkB,KAAK,IAAII,YAAY,CAACJ,KAAK,CAAC;QAC5BA,KAAK,GAAG,IAAI;QACZlB,OAAO,CAACuB,OAAO,CAAC,UAAAC,MAAM,EAAI;UACxBA,MAAM,CAACb,WAAW,GAAGa,MAAM,CAACb,WAAW,CAACF,OAAO,CAAC,GAAGe,MAAM,CAACC,mBAAmB,CAAC,OAAO,EAAEhB,OAAO,CAAC;QACjG,CAAC,CAAC;QACFT,OAAO,GAAG,IAAI;MAChB;IACF,CAAC;IAEDA,OAAO,CAACuB,OAAO,CAAC,UAACC,MAAM;MAAA,OAAKA,MAAM,CAACE,gBAAgB,CAAC,OAAO,EAAEjB,OAAO,CAAC;IAAA,EAAC;IAEtE,IAAOe,MAAM,GAAIlB,UAAU,CAApBkB,MAAM;IAEbA,MAAM,CAACb,WAAW,GAAG;MAAA,OAAMgB,iBAAK,CAACC,IAAI,CAACjB,WAAW,CAAC;IAAA;IAElD,OAAOa,MAAM;EACf;AACF,CAAC;AAAA,IAAAK,QAAA,GAAAC,OAAA,cAEc/B,cAAc","ignoreList":[]}